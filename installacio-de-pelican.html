<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Apunts tècnics: Instal·lació de Pelican</title>
<meta name="description" content="">
<meta name="author" content="Moisès Gómez Girón">

<!-- HTML5 shim, for IE6-8 support of HTML elements -->
<!--[if lt IE 9]>
        <script src="./theme/html5.js"></script>
    <![endif]-->

<!-- Styles -->
<link href="./theme/bootstrap.moi.css" rel="stylesheet">
<link href="./theme/local.css" rel="stylesheet">
<link href="./theme/pygments.css" rel="stylesheet">

<!-- Feeds -->
<link href="http://apuntstecnics.herokuapp.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Apunts tècnics Atom Feed" />

</head>
<body>

<div class="topbar">
    <div class="topbar-inner">
        <div class="container-fluid">
            <a class="brand" href="./">[Apunts tècnics]
 Instal·lació de Pelican             </a>
        </div>
    </div>
</div>

<div class="container-fluid">
    <div class="sidebar">
        <div class="well">
            <!--
            <h3>Temes</h3>
                <ul>
                </ul>
            -->
            <h3>Categories</h3>
            <ul>
                <li ><a href="./category/dev.html">dev</a></li>
                <li ><a href="./category/eines.html">eines</a></li>
                <li class="active"><a href="./category/misc.html">misc</a></li>
            </ul>
            <h3>Tags</h3>
            <ul>
                <li><a href="./tag/java.html">java</a></li>
                <li><a href="./tag/programari.html">programari</a></li>
            </ul>
        </div>
    </div>

    <div class="content">
<div class='article'>
    <div class="page-header"><h1>Instal·lació de Pelican</h1></div>
<div class="well small">
    Entrada ubicada a la categoria
    <a href="./category/misc.html">
        misc
    </a>
</div>
    <div><div class="section" id="introduccio">
<h2>Introducció</h2>
<p>Aquesta pàgina conté una guia d'instal·lació i configuració bàsica del
<a class="reference external" href="http://blog.getpelican.com/">Pelican</a>, el gestor de blocs estàtics
que donen forma a aquests materials, sobre la plataforma <a class="reference external" href="https://www.heroku.com/">Heroku</a> que és el lloc del que descarregues els
continguts.</p>
<p>Les passes estan provades sobre un <a class="reference external" href="https://www.debian.org/index.ca.html">Debian Wheezy</a>, però haurien de funcionar en
altres sistemes sense gaires canvis.</p>
</div>
<div class="section" id="guia-d-installacio">
<h2>Guia d'instal·lació</h2>
<p>Seguint les indicacions del lloc:
<a class="reference external" href="http://docs.getpelican.com/en/3.2/getting_started.html">http://docs.getpelican.com/en/3.2/getting_started.html</a></p>
<p>Assegura't de que disposes d'un python 2.7.x</p>
<p>Farem servir <a class="reference external" href="https://pypi.python.org/pypi/pip">pip</a>. Si no el tens,
instal·lal, ex.:</p>
<div class="highlight"><pre><span class="nv">$ </span>sudo apt-get install python-pip
</pre></div>
<p>També farem servir <a class="reference external" href="http://www.virtualenv.org/en/latest/">virtualenv</a> per permetre crear entorns
aïllats de Python. Si no el tens, el pots instal·lar amb:</p>
<div class="highlight"><pre><span class="nv">$ </span>sudo pip install virtualenv
</pre></div>
<p>Creem un entorn virtual pel pelican i l'activem:</p>
<div class="highlight"><pre><span class="nv">$ </span>virtualenv ~/virtualenvs/pelican
<span class="nv">$ </span><span class="nb">cd</span> ~/virtualenvs/pelican
<span class="nv">$ </span>. bin/activate
</pre></div>
<p>Ara ja podem instal·lar pelican:</p>
<div class="highlight"><pre><span class="nv">$ </span>sudo pip install pelican
</pre></div>
<p>La configuració bàsica de pelican la pots fer amb:</p>
<div class="highlight"><pre><span class="nv">$ </span>pelican-quickstart
</pre></div>
<p>Aquesta comanda et demanarà diferents elements de configuració que
podràs canviar més tard. Et deixarà l'esquelet del lloc allà on hagis
indicat a la primera pregunta.</p>
<p><strong>Atenció</strong>: la versió que estic fent servir (3.2.2) no està preparada
per Unicode. Si també és el teu cas, et recomano que posis qualsevol
cosa sense accents ni caràcters &quot;especials&quot; i després ho canviïs tot
al fitxer de configuració <tt class="docutils literal">pelicanconf.py</tt>.</p>
<p>Un cop ho tens, et trobaràs una estructura de directoris semblant a:</p>
<div class="highlight"><pre>content/
develop_server.sh
Makefile
output/
pelicanconf.py
publishconf.py
</pre></div>
<p>Pots fer un primer post tipus <tt class="docutils literal">holapelican.rst</tt> amb simplement crear
un fitxer amb el següent contingut <a class="footnote-reference" href="#noespecificadata" id="id1">[1]</a>:</p>
<div class="highlight"><pre><span class="gh">############</span>
<span class="gh">Hola Pelican</span>
<span class="gh">############</span>

<span class="nc">:date:</span> <span class="nf">2013-08-06 19:00</span>

El meu primer post
</pre></div>
<p>Converteix-lo a html amb la utilitat <em>make</em>:</p>
<div class="highlight"><pre><span class="nv">$ </span>make html
</pre></div>
<p>I consulta el que has fet, per exemple amb:</p>
<div class="highlight"><pre><span class="nv">$ </span><span class="nb">cd </span>output
output/ <span class="nv">$ </span>python -m SimpleHTTPServer &amp;
output/ <span class="nv">$ </span>iceweasel localhost:8000
</pre></div>
<p>En cas que vulguis gestionar les versions dels continguts del teu
lloc amb git, crea un repositori a l'arrel del teu lloc.</p>
<p>En el meu cas, el que m'interessa és només gestionar les versions dels
fitxers de configuració, donat que els continguts del bloc els tinc a
un altre lloc i no tinc cap interès en l'històric de canvis dels html.</p>
<p>Per tot plegat, he creat el fitxer <cite>.gitignore</cite> a l'arrel del meu lloc
amb els següents continguts:</p>
<div class="highlight"><pre>output/
content/
*.pyc
</pre></div>
<p>Ara, per crear el repositori git farem:</p>
<div class="highlight"><pre><span class="nv">$ </span>git init
<span class="nv">$ </span>git add .
<span class="nv">$ </span>git commit -am <span class="s2">&quot;primer commit&quot;</span>
</pre></div>
<p>Ara que ja el tenim en local, ho passarem al núvol fent servir Heroku.
Si encara no tens un compte, et caldrà fer-te amb un.  És gratuït per
l'ús que farem aquí. Consulta les condicions en cas de dubtes.</p>
<p>Heroku necessita que el que li posem sigui una aplicació. El nostre
objectiu, però, és de moment un bloc estàtic. Així caldrà enganyar-lo
una mica. Li farem creure que el nostre bloc estàtic és una aplicació
php:</p>
<div class="highlight"><pre><span class="nv">$ </span><span class="nb">cd </span>output
<span class="nv">$ </span>touch index.php
<span class="nv">$ </span><span class="nb">echo</span> <span class="s1">&#39;php_flag engine off&#39;</span> &gt; .htaccess
</pre></div>
<p>Ara crearem un repositori git dins de <cite>output/</cite> amb els continguts pel
Heroku i hi afegirem tots els continguts:</p>
<div class="highlight"><pre><span class="nv">$ </span>git init
<span class="nv">$ </span>git add .
<span class="nv">$ </span>git commit -am <span class="s2">&quot;commit inicial per heroku&quot;</span>
</pre></div>
<p>Ara lliguem el nostre projecte amb Heroku (des del directori
<cite>output/</cite>):</p>
<div class="highlight"><pre><span class="nv">$ </span>heroku create nomdelmeubloc
</pre></div>
<p>Fem un <em>push</em> amb:</p>
<div class="highlight"><pre><span class="nv">$ </span>git push heroku master
</pre></div>
<p>Ja podem consultar el nostre bloc a:</p>
<div class="highlight"><pre><span class="nv">$ </span>iceweasel http://nomdelmeubloc.herokuapp.com
</pre></div>
<p>O fent servir el propi <cite>heroku</cite>:</p>
<div class="highlight"><pre><span class="nv">$ </span>heroku app:open
</pre></div>
<p>A partir d'ara, cada cop que vulguis afegir canvis a les entrades del
teu bloc, caldrà que facis el commit i el push a heroku. Si els canvis
inclouen nous fitxers, caldrà també afegir-los al git.</p>
<p>El problema és que el Makefile que ens proporciona Pelican ens
esborrarà els continguts del directori <cite>output/</cite> i amb això el nostre
repositori git i els fitxers generats per enganyar a Heroku.
Per solucionar aquest problema, he creat <cite>aquest script &lt;https://github.com/moiatgit/Utility-scripts/blob/master/pelican2heroku.sh&gt;`_que m'ho fa
automàticament. El script es basa en deixar el repositori de Heroku a
una carpeta diferent de `output/</cite>. Cada cop que es vol publicar (amb
l'opció <cite>--publish</cite>) afegirà al repositori tots els fitxers nous i els
enviarà a Heroku.</p>
</div>
<div class="section" id="notes">
<h2>Notes</h2>
<table class="docutils footnote" frame="void" id="noespecificadata" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td><p class="first">Per defecte, cal especificar la data dels teus
posts o Pelican et donarà un error. Pots fer que Pelican agafi la
data del sistema afegint a <tt class="docutils literal">pelicanconf.py</tt> la següent linia:</p>
<div class="last"><div class="highlight"><pre><span class="nv">DEFAULT_DATE</span> <span class="o">=</span> <span class="s2">&quot;fs&quot;</span>
</pre></div>
</div></td></tr>
</tbody>
</table>
</div>
</div>
</div>
<footer>
  <p>
  <a href=".">Apunts tècnics</a> 
  &copy; 
  <a href="http://www.gnu.org/copyleft/fdl.html">GNU FDL</a>
  per <i>Moisès Gómez Girón </i> (<img style="position:relative;top:+5px;border:0; display:inline;" src="./images/adressamoi.png">)
  amb el generador de blocs <a href="http://getpelican.com/">Pelican</a> 
  </p>
</footer>    </div>
</div>

</body>
</html>