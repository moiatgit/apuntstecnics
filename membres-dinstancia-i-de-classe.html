<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Apunts tècnics: Membres d'instància i de classe</title>
<meta name="description" content="">
<meta name="author" content="Moisès Gómez Girón">

<!-- HTML5 shim, for IE6-8 support of HTML elements -->
<!--[if lt IE 9]>
        <script src="./theme/html5.js"></script>
    <![endif]-->

<!-- Styles -->
<link href="./theme/bootstrap.moi.css" rel="stylesheet">
<link href="./theme/local.css" rel="stylesheet">
<link href="./theme/pygments.css" rel="stylesheet">

<!-- Feeds -->
<link href="http://apuntstecnics.herokuapp.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Apunts tècnics Atom Feed" />

</head>
<body>

<div class="topbar">
    <div class="topbar-inner">
        <div class="container-fluid">
            <a class="brand" href="./">[Apunts tècnics]
 Membres d'instància i de classe             </a>
        </div>
    </div>
</div>

<div class="container-fluid">
    <div class="sidebar">
        <div class="well">
            <!--
            <h3>Temes</h3>
                <ul>
                </ul>
            -->
            <h3>Categories</h3>
            <ul>
                <li ><a href="./category/bd.html">bd</a></li>
                <li ><a href="./category/dev.html">dev</a></li>
                <li ><a href="./category/eines.html">eines</a></li>
                <li ><a href="./category/misc.html">misc</a></li>
                <li class="active"><a href="./category/poo.html">poo</a></li>
                <li ><a href="./category/programacio.html">programacio</a></li>
                <li ><a href="./category/uml.html">uml</a></li>
            </ul>
            <h3>Tags</h3>
            <ul>
                <li><a href="./tag/c.html">C</a></li>
                <li><a href="./tag/jdbc.html">JDBC</a></li>
                <li><a href="./tag/java.html">java</a></li>
                <li><a href="./tag/programari.html">programari</a></li>
                <li><a href="./tag/util.html">util</a></li>
                <li><a href="./tag/test.html">test</a></li>
                <li><a href="./tag/postgresql.html">PostGreSQL</a></li>
            </ul>
        </div>
    </div>

    <div class="content">
<div class='article'>
<div class="well small">
<ul id="navigation"> 
    <li class="navigation-prev">
    <a href="./constructors-part-i.html">
        Constructors (part I)
    </a>
    </li>

    <li class="navigation-top">
    <a href="./un-primer-contacte-amb-la-programacio-en-java.html">
        inici
    </a>
    </li>

    <li class="navigation-next">
    <a href="./relacions-entre-classes.html">
        Relacions entre classes
    </a>
    </li>
</ul> 
</div>
    <div class="page-header"><h1>Membres d'instància i de classe</h1></div>
<div class="well small">
    Entrada ubicada a la categoria
    <a href="./category/poo.html">
        poo
    </a>
            amb el tag:
            <a href="./tag/java.html">java</a> 
        (Darrera modificació: <b> 2014-11-13 </b>)
</div>
    <div><div class="section" id="introduccio">
<h2>Introducció</h2>
<p>Tot i que habitualment els membres que definim a les nostres classes,
estan orientats a cada instància concreta de la classe, hi ha
ocasions en que ens cal disposar de mètodes o/i propietats que facin
referència a tota la classe i no a una instància concreta d'aquesta.</p>
<p>En aquest document es discuteix aquesta possibilitat en forma de
membres d'instància i de classe.</p>
<p>Com a <em>extra</em> se li afegeix el concepte de <em>final</em> què,
simplificant-ho molt, permet indicar que quelcom és constant.</p>
<p>Es pressuposa que s'ha seguit els continguts de <a class="reference external" href="./classes-i-objectes.html">classes i objectes</a>.</p>
</div>
<div class="section" id="exercici-1-metodes-de-classe">
<h2>Exercici 1. Mètodes de classe</h2>
<p>Fins ara, tots els mètodes que hem programat depenien d'una instància
per a funcionar. Tots? Bé, potser només fins on hem estat conscients.</p>
<p>Per cridar-los, ens calia indicar «referència a la instància».«nom del
mètode» o, des del codi d'un mètode de la classe també podíem
directament cridar el nom del mètode.</p>
<p>Per exemple, a la classe Hora, el mètode d'incrementar un segon
requeria una instància d'hora a qui aplicar-lo. Dèiem</p>
<div class="highlight"><pre><span class="n">Hora</span> <span class="n">h</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Hora</span><span class="o">();</span>
<span class="n">h</span><span class="o">.</span><span class="na">incrSeg</span><span class="o">();</span>
</pre></div>
<p>Ara bé, imagina que volguéssim comprovar que els valors d'una hora són
vàlids abans d'assignar-los a una instància de Hora. El mètode podria
ser quelcom semblant a</p>
<div class="highlight"><pre><span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">esValida</span><span class="o">(</span><span class="kt">int</span> <span class="n">h</span><span class="o">,</span> <span class="kt">int</span> <span class="n">m</span><span class="o">,</span> <span class="kt">int</span> <span class="n">s</span><span class="o">)</span> <span class="o">{...}</span>
</pre></div>
<p>Aquest mètode, però, no requeriria l'accés a l'estat de cap instància
de Hora, i amb qualsevol instància de Hora hauria de donar el mateix
resultat. Per a poder-lo usar, ens caldria, però, crear una instància
que probablement no la voldrem per res més. Per exemple:</p>
<div class="highlight"><pre><span class="k">if</span> <span class="o">(</span><span class="k">new</span> <span class="n">Hora</span><span class="o">().</span><span class="na">esValida</span><span class="o">(</span><span class="mi">14</span><span class="o">,</span> <span class="mi">12</span><span class="o">,</span> <span class="mi">21</span><span class="o">))</span> <span class="o">{</span>
    <span class="n">Hora</span> <span class="n">hora</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Hora</span><span class="o">(</span><span class="mi">14</span><span class="o">,</span> <span class="mi">12</span><span class="o">,</span> <span class="mi">21</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
<p>Per a solucionar aquest tipus de situacions, la POO ens ofereix la
possibilitat de distingir mètodes de classe de mètodes d'instància.
Aquest de esValida() seria clarament un mètode de classe ja que no depèn
de cap instància per a ser executat.</p>
<p>Java ens permet indicar que un mètode és de classe amb la paraula
reservada static. Així, el mètode <tt class="docutils literal">esValida()</tt> tindria el següent aspecte</p>
<div class="highlight"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="kt">boolean</span> <span class="nf">esValida</span><span class="o">(</span><span class="kt">int</span> <span class="n">h</span><span class="o">,</span> <span class="kt">int</span> <span class="n">m</span><span class="o">,</span> <span class="kt">int</span> <span class="n">s</span><span class="o">)</span> <span class="o">{...}</span>
</pre></div>
<p>Per a ser utilitzat, a banda de com abans, també podríem fer-ho d'una
manera més eficient amb:</p>
<div class="highlight"><pre><span class="k">if</span> <span class="o">(</span><span class="n">Hora</span><span class="o">.</span><span class="na">esValida</span><span class="o">(</span><span class="mi">14</span><span class="o">,</span> <span class="mi">12</span><span class="o">,</span> <span class="mi">21</span><span class="o">))</span> <span class="o">{</span>
    <span class="n">Hora</span> <span class="n">hora</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Hora</span><span class="o">(</span><span class="mi">14</span><span class="o">,</span> <span class="mi">12</span><span class="o">,</span> <span class="mi">21</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
<p>Fixa't que ara, en comptes de cridar al mètode des d'una instància, ho
fem directament a partir de la classe!</p>
<p>Ara potser comença a tenir sentit la paraula <tt class="docutils literal">static</tt> del
<tt class="docutils literal">main()</tt>, oi?</p>
<p>En aquest exercici es demana que ampliïs la classe Hora amb els
mètodes estàtics:</p>
<ul class="simple">
<li><tt class="docutils literal">boolean esValida(int, int, int)</tt>: retorna true si i només sí les
hores, minuts i segons indicats, en aquest ordre, pels paràmetres,
corresponen a una combinació vàlida per una hora.</li>
<li><tt class="docutils literal">int compareTo(Hora, Hora)</tt>: retorna -1 si la primera hora és
menor que (anterior a) la segona, 0 si són iguals i 1 si la primera
és més gran que (posterior a) la segona.</li>
<li><tt class="docutils literal">Hora duplica(Hora)</tt>: retorna una nova instància de la classe Hora
amb els mateixos valors per les propietats de l'hora rebuda.</li>
</ul>
<p>Aquest últim retorna una nova instància de Hora amb els mateixos
valors de la que rep.</p>
</div>
<div class="section" id="exercici-2-propietats-de-classe">
<h2>Exercici 2. Propietats de classe</h2>
<p>Les propietats també poden ser de classe.</p>
<p>Un dels exemples més típics és el de portar el comptador de quantes instàncies d'una classe s'han creat.</p>
<p>Considera el següent codi, executa'l i intenta entendre el perquè de la sortida</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35</pre></div></td><td class="code"><div class="highlight"><pre><span class="cm">/* Demostració d&#39;ús de membres de classe */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">GatRenat</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">numInstancies</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">vides</span> <span class="o">=</span> <span class="mi">7</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">GatRenat</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// constructor per defecte incrementa el nombre d&#39;instàncies</span>
        <span class="n">GatRenat</span><span class="o">.</span><span class="na">numInstancies</span><span class="o">++;</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Creat un nou gat Renat. Ja van &quot;</span> <span class="o">+</span> <span class="n">numInstancies</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">getNumInstancies</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// retorna el nombre d&#39;instàncies creades fins el moment</span>
        <span class="k">return</span> <span class="n">numInstancies</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getVides</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="n">vides</span><span class="o">;</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setVides</span><span class="o">(</span><span class="kt">int</span> <span class="n">vides</span><span class="o">)</span> <span class="o">{</span> <span class="k">if</span> <span class="o">(</span><span class="n">vides</span><span class="o">&gt;=</span><span class="mi">0</span><span class="o">)</span> <span class="k">this</span><span class="o">.</span><span class="na">vides</span> <span class="o">=</span> <span class="n">vides</span><span class="o">;</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span> <span class="k">return</span> <span class="s">&quot;Gat Renat amb &quot;</span> <span class="o">+</span> <span class="n">vides</span> <span class="o">+</span> <span class="s">&quot; vides&quot;</span><span class="o">;</span> <span class="o">}</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Inicialment el nombre d&#39;instàncies és: &quot;</span> <span class="o">+</span>
            <span class="n">GatRenat</span><span class="o">.</span><span class="na">getNumInstancies</span><span class="o">());</span>
        <span class="c1">// crea uns quants GatRenat per demostrar l&#39;ús de membres estàtics</span>
        <span class="n">GatRenat</span><span class="o">[]</span> <span class="n">gats</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GatRenat</span><span class="o">[</span><span class="mi">10</span><span class="o">];</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">gats</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">gats</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">GatRenat</span><span class="o">();</span>
            <span class="n">gats</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">setVides</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>    <span class="c1">// canviem les vides només per distingir-los</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Tenim: &quot;</span> <span class="o">+</span> <span class="n">gats</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">+</span> <span class="s">&quot; amb &quot;</span> <span class="o">+</span>
                <span class="n">gats</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">getNumInstancies</span><span class="o">()</span> <span class="o">+</span> <span class="s">&quot; germanets&quot;</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="c1">// tornem a demanar a cadascun quants germans té</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;I si tornem a demanar-los quants germans tenen, ens diuen:&quot;</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">gats</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">gats</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">toString</span><span class="o">()</span> <span class="o">+</span> <span class="s">&quot; amb &quot;</span> <span class="o">+</span>
                <span class="n">gats</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">getNumInstancies</span><span class="o">()</span> <span class="o">+</span> <span class="s">&quot; germanets&quot;</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table><p>Demostra que l'has entès realitzant la següent modificació al codi:</p>
<ul class="simple">
<li>cada gat haurà de tenir un número identificador que indiqui en quin
ordre va nàixer respecte els seus germans.</li>
<li>Aquest identificador es podrà demanar (amb el mètode <tt class="docutils literal"><span class="pre">get«X»()</span></tt>),
però no modificar; i apareixerà a la cadena retornada pel mètode
<tt class="docutils literal">toString()</tt>.</li>
</ul>
<p>Nota: la darrera crida a <tt class="docutils literal">println()</tt> es podria escriure més
simple, sense necessitat de cridar explícitament al mètode
<tt class="docutils literal">toString()</tt>. Considera:</p>
<div class="highlight"><pre><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">gats</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">+</span> <span class="s">&quot; amb &quot;</span> <span class="o">+</span>
    <span class="n">gats</span><span class="o">[</span><span class="n">i</span><span class="o">].</span><span class="na">getNumInstancies</span><span class="o">()</span> <span class="o">+</span> <span class="s">&quot; germanets&quot;</span><span class="o">);</span>
</pre></div>
<p>El mètode <tt class="docutils literal">toString()</tt> té la particularitat de ser cridat
(implícitament) en alguns contextos on s'espera un String, com ara en
aquesta concatenació de Strings que passem a <tt class="docutils literal">println()</tt>.</p>
</div>
<div class="section" id="exercici-3-propietats-finals">
<h2>Exercici 3. Propietats finals</h2>
<p>La paraula clau final pot ser aplicada a diferents elements.</p>
<p>L'aplicació a classes té a veure amb el concepte d'herència que no es
tracta en aquest document.</p>
<p>L'aplicació a mètodes sovint està també relacionada amb l'herència. Un
altre ús és per l'eficiència: el compilador pot substituir les crides
al mètode final pel seu codi (<em>inline call</em>). Tot i que teòricament
Java sap quan ha de fer aquestes substitucions, es recomana només
indicar final per temes d'eficiència a mètodes molt breus o el codi
podria tornar-se massa gran. En aquestes primeres etapes
d'aprenentatge de la POO i de Java, no cal que ens preocupem d'aquest
tipus d'optimització.</p>
<p>L'aplicació a paràmetres permet indicar que el paràmetre no pot
canviar el seu valor dins del codi (paràmetres <em>read-only</em>) De la
mateixa manera, si indiquem que una variable és final, només li podrem
assignar valor un sol cop.</p>
<p>L'aplicació a propietats permet indicar que la propietat només pot
rebre un valor un cop en tota l'execució. És una mena de constant de
la instància. En cas que hi afegim <tt class="docutils literal">static</tt>, la constant és de la
classe.</p>
<p>També podem afegir <em>final</em> a una variable. El comportament és el
mateix que amb les propietats: el compilador només permet assignar un
cop a la variable.</p>
<p>Nota: en cas que la propietat o variable referenciï a una instància
mutable (que els valors de les seves propietats puguin ser
modificats), fer que la propietat/variable sigui final <strong>no</strong>
converteix la instància referenciada en immutable, només impedeix que
la referència canviï a una altra instància. Per exemple:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span class="kd">class</span> <span class="nc">A</span> <span class="o">{</span> <span class="kt">int</span> <span class="n">i</span><span class="o">;</span> <span class="o">}</span>
<span class="kd">class</span> <span class="nc">B</span> <span class="o">{</span>
    <span class="kd">final</span> <span class="n">A</span> <span class="n">a</span> <span class="o">=</span> <span class="k">new</span> <span class="n">A</span><span class="o">();</span>
    <span class="kt">void</span> <span class="nf">canviaI</span><span class="o">(</span><span class="kt">int</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">a</span><span class="o">.</span><span class="na">i</span> <span class="o">=</span> <span class="n">v</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="kt">void</span> <span class="nf">canviaA</span><span class="o">(</span><span class="n">A</span> <span class="n">nova</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">nova</span><span class="o">;</span>   <span class="c1">// error de compilació</span>
                    <span class="c1">// &quot;error: cannot assign a value to final variable a&quot;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table><p>Per a aquest exercici es demana que trobis una manera d'aplicar el
concepte de propietat final a la teva resposta del problema anterior.</p>
</div>
</div>
<div class="well small">
<ul id="navigation"> 
    <li class="navigation-prev">
    <a href="./constructors-part-i.html">
        Constructors (part I)
    </a>
    </li>

    <li class="navigation-top">
    <a href="./un-primer-contacte-amb-la-programacio-en-java.html">
        inici
    </a>
    </li>

    <li class="navigation-next">
    <a href="./relacions-entre-classes.html">
        Relacions entre classes
    </a>
    </li>
</ul> 
</div>
</div>
<footer>
  <p>
  <a href=".">Apunts tècnics</a> 
  &copy; 
  <a href="http://www.gnu.org/copyleft/fdl.html">GNU FDL</a>
  per <i>Moisès Gómez Girón </i> (<img style="position:relative;top:+5px;border:0; display:inline;" src="./images/adressamoi.png">)
  amb el generador de blocs <a href="http://getpelican.com/">Pelican</a> 
  </p>
</footer>    </div>
</div>

</body>
</html>