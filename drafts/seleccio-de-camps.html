<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Apunts tècnics: Selecció de camps</title>
<meta name="description" content="">
<meta name="author" content="Moisès Gómez Girón">

<!-- HTML5 shim, for IE6-8 support of HTML elements -->
<!--[if lt IE 9]>
        <script src="../theme/html5.js"></script>
    <![endif]-->

<!-- Styles -->
<link href="../theme/bootstrap.moi.css" rel="stylesheet">
<link href="../theme/local.css" rel="stylesheet">
<link href="../theme/pygments.css" rel="stylesheet">

<!-- Feeds -->
<link href="http://apuntstecnics.herokuapp.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Apunts tècnics Atom Feed" />

</head>
<body>

<div class="topbar">
    <div class="topbar-inner">
        <div class="container-fluid">
            <a class="brand" href="../">[Apunts tècnics]
 Selecció de camps             </a>
        </div>
    </div>
</div>

<div class="container-fluid">
    <div class="sidebar">
        <div class="well">
            <!--
            <h3>Temes</h3>
                <ul>
                </ul>
            -->
            <h3>Categories</h3>
            <ul>
                <li class="active"><a href="../category/bd.html">bd</a></li>
                <li ><a href="../category/dev.html">dev</a></li>
                <li ><a href="../category/eines.html">eines</a></li>
                <li ><a href="../category/misc.html">misc</a></li>
                <li ><a href="../category/poo.html">poo</a></li>
                <li ><a href="../category/programacio.html">programacio</a></li>
                <li ><a href="../category/uml.html">uml</a></li>
            </ul>
            <h3>Tags</h3>
            <ul>
                <li><a href="../tag/c.html">C</a></li>
                <li><a href="../tag/java.html">java</a></li>
                <li><a href="../tag/programari.html">programari</a></li>
                <li><a href="../tag/util.html">util</a></li>
                <li><a href="../tag/test.html">test</a></li>
                <li><a href="../tag/postgresql.html">PostGreSQL</a></li>
            </ul>
        </div>
    </div>

    <div class="content">
<div class='article'>
    <div class="page-header"><h1>Selecció de camps</h1></div>
<div class="well small">
    Entrada ubicada a la categoria
    <a href="../category/bd.html">
        bd
    </a>
            amb el tag:
            <a href="../tag/mongodb.html">mongoDB</a> 
</div>
    <div><div class="section" id="introduccio">
<h2>Introducció</h2>
<p>Ara que sabem com podem seleccionar els documents que ens interessa,
potser que ens comencem a plantejar com discriminar quins camps ens
calen de les consultes.</p>
<p>SQL ens ofereix la possibilitat d'especificar a la clàusula <em>SELECT</em>
quins són els camps que volem. Per exemple,</p>
<div class="highlight"><pre><span class="k">SELECT</span> <span class="n">nom</span><span class="p">,</span> <span class="n">professio</span> <span class="k">FROM</span> <span class="n">persones</span><span class="p">;</span>
</pre></div>
<p>En aquest article aprendrem com fer l'equivalent amb MongoDB.</p>
</div>
<div class="section" id="limitar-els-camps">
<h2>Limitar els camps</h2>
<p>El primer paràmetre de <em>find</em> ens permet &quot;retallar horitzontalment&quot;
els resultats. És a dir, ens quedem només amb els documents que
coincideixen amb els valors indicats.</p>
<p>El mètode <em>find</em> accepta un segon paràmetre que ens ofereix la
possibilitat de &quot;retallar verticalment&quot;, és a dir, podrem quedar-nos
només amb els <em>camps</em> que ens interessin.</p>
<div class="figure align-center">
<img alt="Representació de la selecció horitzontal i vertical" src="../images/mongodb.008.img001.seleccio_find.png" />
</div>
<p>A aquest segon camp se li sol anomenar <em>projecció</em>, amb el sentit que
el resultat no són les dades originals sinó una &quot;projecció&quot; (si vols,
l'&quot;ombra&quot;) d'aquestes.</p>
<p>La figura anterior mostra el resultat de la consulta:</p>
<div class="highlight"><pre><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">persones</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="s1">&#39;professió&#39;</span><span class="o">:</span><span class="s1">&#39;desenvolupador/a&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;nom&#39;</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span> <span class="s1">&#39;edat&#39;</span><span class="o">:</span><span class="kc">true</span><span class="p">})</span>
</pre></div>
<p>Fixa't que indiquem els camps que volem que apareguin simplement amb
el seu nom i com a valor <em>true</em>. De fet, podem posar un 1 en comptes
de <em>true</em> però he preferit indicar-ho així per fer-ho més evident.</p>
<p>Si executes la comanda anterior, hauràs vist que el resultat no és
exàctament el que apareix a la figura. La consulta <em>real</em> mostra també
el camp <em>_id</em>. La clau dels documents apareix per defecte, per a
poder-la ocultar, haurem d'indicar-ho explícitament:</p>
<div class="highlight"><pre><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">persones</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="s1">&#39;professió&#39;</span><span class="o">:</span><span class="s1">&#39;desenvolupador/a&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;_id&#39;</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span> <span class="s1">&#39;nom&#39;</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span> <span class="s1">&#39;edat&#39;</span><span class="o">:</span><span class="kc">true</span><span class="p">})</span>
<span class="p">{</span> <span class="s2">&quot;nom&quot;</span> <span class="o">:</span> <span class="s2">&quot;Irene Ruíz Cloquell&quot;</span><span class="p">,</span> <span class="s2">&quot;edat&quot;</span> <span class="o">:</span> <span class="mi">44</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;nom&quot;</span> <span class="o">:</span> <span class="s2">&quot;Iker Navarro López&quot;</span><span class="p">,</span> <span class="s2">&quot;edat&quot;</span> <span class="o">:</span> <span class="mi">35</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;nom&quot;</span> <span class="o">:</span> <span class="s2">&quot;Pol Fernández García&quot;</span><span class="p">,</span> <span class="s2">&quot;edat&quot;</span> <span class="o">:</span> <span class="mi">34</span> <span class="p">}</span>
</pre></div>
<p>En cas que vulguem mostrar tots els camps excepte l'identificador,
no cal que afegim cada clau a la projecció. Hi haurà prou amb què
indiquem que no volem l'identificador.</p>
<div class="highlight"><pre><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">persones</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="s1">&#39;professió&#39;</span><span class="o">:</span><span class="s1">&#39;desenvolupador/a&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;_id&#39;</span><span class="o">:</span><span class="kc">false</span><span class="p">})</span>
<span class="p">{</span> <span class="s2">&quot;nom&quot;</span><span class="o">:</span><span class="s2">&quot;Irene Ruíz Cloquell&quot;</span><span class="p">,</span> <span class="s2">&quot;edat&quot;</span><span class="o">:</span><span class="mi">44</span><span class="p">,</span> <span class="s2">&quot;professió&quot;</span><span class="o">:</span><span class="s2">&quot;desenvolupador/a&quot;</span><span class="p">,</span> <span class="s2">&quot;sou&quot;</span><span class="o">:</span><span class="mi">2500</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;nom&quot;</span><span class="o">:</span><span class="s2">&quot;Iker Navarro López&quot;</span><span class="p">,</span> <span class="s2">&quot;edat&quot;</span><span class="o">:</span><span class="mi">35</span><span class="p">,</span> <span class="s2">&quot;professió&quot;</span><span class="o">:</span><span class="s2">&quot;desenvolupador/a&quot;</span><span class="p">,</span> <span class="s2">&quot;sou&quot;</span><span class="o">:</span><span class="mi">2800</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&quot;nom&quot;</span><span class="o">:</span><span class="s2">&quot;Pol Fernández García&quot;</span><span class="p">,</span> <span class="s2">&quot;edat&quot;</span><span class="o">:</span><span class="mi">34</span><span class="p">,</span> <span class="s2">&quot;professió&quot;</span><span class="o">:</span><span class="s2">&quot;desenvolupador/a&quot;</span><span class="p">,</span> <span class="s2">&quot;sou&quot;</span><span class="o">:</span><span class="mi">1800</span> <span class="p">}</span>
</pre></div>
<p>Una cosa més, si volem mostrar tots els documents, simplement hem de
deixar el camp de sel·lecció (el primer camp del <em>find</em>) amb el
document buit: {}.</p>
<div class="highlight"><pre><span class="o">&gt;</span> <span class="nx">db</span><span class="p">.</span><span class="nx">persones</span><span class="p">.</span><span class="nx">find</span><span class="p">({},</span> <span class="p">{</span><span class="s1">&#39;_id&#39;</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span> <span class="s1">&#39;nom&#39;</span><span class="o">:</span><span class="kc">true</span><span class="p">,</span> <span class="s1">&#39;edat&#39;</span><span class="o">:</span><span class="kc">true</span><span class="p">})</span>
</pre></div>
<div class="section" id="exercici-1-quadrats-retallats">
<h3>Exercici 1. Quadrats retallats</h3>
<p>Defineix una consulta que mostri només els camps <em>val</em> i <em>quadrat</em> de
la col·lecció <em>quadrats</em>.</p>
</div>
<div class="section" id="exercici-2-retalls-confosos">
<h3>Exercici 2. Retalls confosos</h3>
<p>Comprova què passa si indiques a la projeccció que una mateixa clau
sigui mostrada i no mostrada a l'hora.</p>
</div>
</div>
</div>
</div>
<footer>
  <p>
  <a href="..">Apunts tècnics</a> 
  &copy; 
  <a href="http://www.gnu.org/copyleft/fdl.html">GNU FDL</a>
  per <i>Moisès Gómez Girón </i> (<img style="position:relative;top:+5px;border:0; display:inline;" src="../images/adressamoi.png">)
  amb el generador de blocs <a href="http://getpelican.com/">Pelican</a> 
  </p>
</footer>    </div>
</div>

</body>
</html>